<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>STANDOFF GOLD</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>

<style>
*{ -webkit-tap-highlight-color:transparent }
body{
  margin:0;
  background:radial-gradient(circle at top,#0b0f1a 0%,#05070f 70%);
  font-family:-apple-system,BlinkMacSystemFont,Arial,sans-serif;
  color:#fff;
}
.screen{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:20px;
}
.app{
  height:100vh;
  display:grid;
  grid-template-rows:auto 1fr auto;
  padding:16px;
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.lang span{
  margin-left:8px;
  cursor:pointer;
  opacity:.6;
}
.lang .active{opacity:1;font-weight:700}
.title{
  font-weight:900;
  letter-spacing:2px;
  color:#ffd36a;
}
.gold{
  color:#ffd36a;
  font-size:26px;
  font-weight:900;
}
.center{
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}
.core{
  width:220px;height:220px;border-radius:18px;
  background:radial-gradient(circle at 30% 30%,#ffd36a,#c9a132 70%);
  box-shadow:0 0 30px rgba(255,211,106,.55);
  display:flex;align-items:center;justify-content:center;
  font-weight:900;color:#2b1c00;
  cursor:pointer;user-select:none;
}
.core:active{transform:scale(.95)}
.float{
  position:absolute;
  font-weight:800;
  color:#ffd36a;
  animation:floatUp .9s ease forwards;
}
@keyframes floatUp{
  from{transform:translateY(0);opacity:1}
  to{transform:translateY(-60px);opacity:0}
}
.btn{
  width:100%;height:44px;
  border-radius:12px;border:none;
  background:#ffd36a;
  color:#2b1c00;
  font-weight:900;
  cursor:pointer;
  margin-top:8px;
}
.btn.secondary{
  background:transparent;
  border:1px solid #ffd36a;
  color:#ffd36a;
}
input{
  width:100%;height:44px;
  border-radius:12px;border:none;
  padding:0 12px;
  margin-top:8px;
}
.card{
  background:rgba(255,255,255,.05);
  border-radius:14px;
  padding:12px;
  margin-top:10px;
}
.small{font-size:12px;opacity:.8}
ul{padding-left:16px;margin:6px 0}
</style>
</head>

<body>
<div id="app"></div>

<script>
/* ===== CONFIG ===== */
const TG_CHANNEL = 'https://t.me/+s1VSvO5kwp45OTFi';
const DAILY_LIMIT = 1000;
const RATE = 0.1;               // 1 tap = 0.1 G
const MIN_WITHDRAW = 10;
const BOOST_TIME = 30;          // сек
const BOOST_COOLDOWN = 60;      // сек

/* ===== I18N ===== */
const TXT={
  ru:{
    loading:'Загрузка…',
    name:'Введите имя',
    save:'Сохранить',
    tap:'Тапай и фарми Gold',
    withdraw:'Вывод Gold',
    amount:'Сумма вывода (G)',
    gid:'Игровой ID',
    rate:'Курс: 100 TAPS = 10 G',
    limit:(a)=>`Лимит: ${a}/${DAILY_LIMIT}`,
    boost:'BOOST x2',
    boostOn:(s)=>`Буст активен (${s}с)`,
    boostCd:(s)=>`КД ${s}с`,
    lb:'Лидерборд'
  },
  en:{
    loading:'Loading…',
    name:'Enter name',
    save:'Save',
    tap:'Tap to farm Gold',
    withdraw:'Withdraw Gold',
    amount:'Withdraw amount (G)',
    gid:'Game ID',
    rate:'Rate: 100 TAPS = 10 G',
    limit:(a)=>`Limit: ${a}/${DAILY_LIMIT}`,
    boost:'BOOST x2',
    boostOn:(s)=>`Boost active (${s}s)`,
    boostCd:(s)=>`Cooldown ${s}s`,
    lb:'Leaderboard'
  }
};
let lang=localStorage.getItem('lang')||'ru';

/* ===== STATE ===== */
let name=localStorage.getItem('name');
let gold=+localStorage.getItem('gold')||0;
let tapsToday=+localStorage.getItem('taps_today')||0;
let day=localStorage.getItem('tap_day');
let screen='loading';

let boost=false, boostLeft=0, boostCd=0;

/* DAILY RESET */
const today=new Date().toDateString();
if(day!==today){
  tapsToday=0;
  localStorage.setItem('tap_day',today);
  localStorage.setItem('taps_today',0);
}

/* ===== ROOT ===== */
const app=document.getElementById('app');

/* ===== RENDER ===== */
function render(){
  const t=TXT[lang];

  if(screen==='loading'){
    app.innerHTML=`<div class="screen"><h2>${t.loading}</h2></div>`;
    setTimeout(()=>{
      screen=name?'game':'name';
      render();
    },1200);
    return;
  }

  if(screen==='name'){
    app.innerHTML=`
      <div class="screen">
        <h2>${t.name}</h2>
        <input id="nm">
        <button class="btn" onclick="saveName()">${t.save}</button>
      </div>`;
    return;
  }

  if(screen==='game'){
    app.innerHTML=`
      <div class="app">
        <div class="top">
          <div class="title">${name}</div>
          <div class="lang">
            <span class="${lang==='ru'?'active':''}" onclick="setLang('ru')">RU</span>|
            <span class="${lang==='en'?'active':''}" onclick="setLang('en')">EN</span>
          </div>
        </div>

        <div class="center" id="zone">
          <div class="core" id="core">${t.tap}</div>
        </div>

        <div class="gold">${gold.toFixed(1)} G</div>
        <div class="small">${t.limit(tapsToday)}</div>

        <div class="card">
          <button class="btn" onclick="useBoost()">
            ${boost ? t.boostOn(boostLeft) :
              boostCd>0 ? t.boostCd(boostCd) : t.boost}
          </button>
        </div>

        <div class="card">
          <h4>${t.lb}</h4>
          <ul id="lb"></ul>
        </div>

        <button class="btn secondary" onclick="screen='withdraw';render()">
          ${t.withdraw}
        </button>
      </div>`;
    bindTap();
    renderLB();
    return;
  }

  if(screen==='withdraw'){
    app.innerHTML=`
      <div class="screen">
        <h2>${t.withdraw}</h2>
        <div class="small">${t.rate}</div>
        <input id="gid" placeholder="${t.gid}">
        <input id="amt" placeholder="${t.amount}">
        <button class="btn" onclick="withdraw()">${t.withdraw}</button>
        <button class="btn secondary" onclick="screen='game';render()">← Back</button>
      </div>`;
  }
}

/* ===== ACTIONS ===== */
function saveName(){
  const v=document.getElementById('nm').value.trim();
  if(v){
    name=v;
    localStorage.setItem('name',name);
    screen='game';
    render();
  }
}

function bindTap(){
  const core=document.getElementById('core');
  const zone=document.getElementById('zone');
  core.onclick=e=>{
    if(tapsToday>=DAILY_LIMIT) return;

    tapsToday++;
    localStorage.setItem('taps_today',tapsToday);

    const gain = RATE * (boost?2:1);
    gold+=gain;
    localStorage.setItem('gold',gold);

    const r=zone.getBoundingClientRect();
    const f=document.createElement('div');
    f.className='float';
    f.textContent=`+${gain}G`;
    f.style.left=(e.clientX-r.left)+'px';
    f.style.top=(e.clientY-r.top)+'px';
    zone.appendChild(f);
    setTimeout(()=>f.remove(),900);

    updateLB();
    render();
  };
}

function useBoost(){
  if(boost || boostCd>0) return;
  boost=true;
  boostLeft=BOOST_TIME;
  const int=setInterval(()=>{
    boostLeft--;
    if(boostLeft<=0){
      clearInterval(int);
      boost=false;
      boostCd=BOOST_COOLDOWN;
      const cdInt=setInterval(()=>{
        boostCd--;
        if(boostCd<=0) clearInterval(cdInt);
        render();
      },1000);
    }
    render();
  },1000);
}

function withdraw(){
  const id=document.getElementById('gid').value;
  const amt=parseFloat(document.getElementById('amt').value);
  if(!/^[0-9]+$/.test(id)||amt<MIN_WITHDRAW||amt>gold){
    alert('Invalid data');
    return;
  }
  gold-=amt;
  localStorage.setItem('gold',gold);
  alert('Success');
  screen='game';
  render();
}

/* ===== LEADERBOARD ===== */
function updateLB(){
  let lb=JSON.parse(localStorage.getItem('lb')||'[]');
  lb.push({name,gold});
  lb=lb.sort((a,b)=>b.gold-a.gold).slice(0,5);
  localStorage.setItem('lb',JSON.stringify(lb));
}
function renderLB(){
  const ul=document.getElementById('lb');
  if(!ul) return;
  const lb=JSON.parse(localStorage.getItem('lb')||'[]');
  ul.innerHTML='';
  lb.forEach((e,i)=>{
    const li=document.createElement('li');
    li.textContent=`${i+1}. ${e.name} — ${e.gold.toFixed(1)}G`;
    ul.appendChild(li);
  });
}

function setLang(l){
  lang=l;
  localStorage.setItem('lang',lang);
  render();
}

/* ===== START ===== */
render();
</script>
</body>
</html>
